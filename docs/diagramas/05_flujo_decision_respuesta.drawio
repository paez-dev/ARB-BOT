<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36 Edg/142.0.0.0" version="29.2.1">
  <diagram id="flujo-decision-respuesta" name="Flujo de DecisiÃ³n de Respuesta">
    <mxGraphModel dx="1418" dy="786" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="titulo" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" value="ðŸŽ¯ FLUJO DE DECISIÃ“N DE RESPUESTA" vertex="1">
          <mxGeometry height="40" width="500" x="300" y="20" as="geometry" />
        </mxCell>
        <mxCell id="subtitulo" parent="1" style="text;html=1;strokeColor=none;fillColor=#E3F2FD;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=14;strokeColor=#1976D2" value="Sistema anti-alucinaciÃ³n de ARB-BOT" vertex="1">
          <mxGeometry height="30" width="340" x="380" y="65" as="geometry" />
        </mxCell>
        <mxCell id="inicio" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1" value="ðŸ“¥ Pregunta del Usuario recibida" vertex="1">
          <mxGeometry height="50" width="300" x="400" y="109" as="geometry" />
        </mxCell>
        <mxCell id="arrow1" edge="1" parent="1" source="inicio" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#1976D2;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" target="decision1" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="decision1" parent="1" style="rhombus;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#E65100;fontSize=14;fontStyle=1" value="â“ Â¿Hay contexto&#xa;disponible en&#xa;Supabase?" vertex="1">
          <mxGeometry height="100" width="240" x="430" y="200" as="geometry" />
        </mxCell>
        <mxCell id="si-label1" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#388E3C;" value="âœ… SÃ" vertex="1">
          <mxGeometry height="20" width="50" x="379" y="228" as="geometry" />
        </mxCell>
        <mxCell id="no-label1" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#D32F2F;" value="âŒ NO" vertex="1">
          <mxGeometry height="20" width="50" x="686" y="223" as="geometry" />
        </mxCell>
        <mxCell id="arrow-si1" edge="1" parent="1" source="decision1" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#388E3C;exitX=0;exitY=0.5;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" target="llm-box" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-no1" edge="1" parent="1" source="decision1" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#D32F2F;exitX=1;exitY=0.5;entryX=-0.007;entryY=0.425;entryDx=0;entryDy=0;entryPerimeter=0;" target="fallback-box" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="llm-box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#388E3C;strokeWidth=2;" value="" vertex="1">
          <mxGeometry height="160" width="280" x="80" y="170" as="geometry" />
        </mxCell>
        <mxCell id="fallback-box" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFCDD2;strokeColor=#D32F2F;strokeWidth=2;" value="" vertex="1">
          <mxGeometry height="160" width="280" x="760" y="180" as="geometry" />
        </mxCell>
        <mxCell id="fallback-title" parent="1" style="text;html=1;strokeColor=none;fillColor=#D32F2F;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=12;fontStyle=1;fontColor=#FFFFFF" value="âš ï¸ Respuesta FALLBACK" vertex="1">
          <mxGeometry height="25" width="260" x="770" y="195" as="geometry" />
        </mxCell>
        <mxCell id="fallback-content" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=2" value="&quot;Actualmente no tengo&#xa;informaciÃ³n cargada sobre&#xa;ese tema especÃ­fico.&#xa;&#xa;Te sugiero consultar&#xa;directamente en CoordinaciÃ³n.&quot;" vertex="1">
          <mxGeometry height="100" width="260" x="770" y="230" as="geometry" />
        </mxCell>
        <mxCell id="arrow2" edge="1" parent="1" source="llm-box" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#1976D2;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" target="decision2" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="decision2" parent="1" style="rhombus;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;fontSize=12;fontStyle=1" value="ðŸ” Â¿Respuesta contiene&#xa;patrones bloqueados?" vertex="1">
          <mxGeometry height="100" width="240" x="100" y="470" as="geometry" />
        </mxCell>
        <mxCell id="patrones" parent="1" style="text;html=1;strokeColor=none;fillColor=#FCE4EC;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=10;spacingLeft=10" value="Patrones bloqueados:&#xa;â€¢ &quot;Soy un modelo de lenguaje&quot;&#xa;â€¢ &quot;No tengo acceso a...&quot;&#xa;â€¢ &quot;Como IA, no puedo...&quot;&#xa;â€¢ &quot;Mi conocimiento se basa en...&quot;" vertex="1">
          <mxGeometry height="90" width="200" x="240" y="370" as="geometry" />
        </mxCell>
        <mxCell id="no-label2" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#388E3C;" value="âœ… NO" vertex="1">
          <mxGeometry height="20" width="50" x="160" y="610" as="geometry" />
        </mxCell>
        <mxCell id="si-label2" parent="1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1;fontColor=#FF6F00;" value="âš ï¸ SÃ" vertex="1">
          <mxGeometry height="20" width="50" x="360" y="520" as="geometry" />
        </mxCell>
        <mxCell id="arrow-no2" edge="1" parent="1" source="decision2" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#388E3C;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" target="enviar-ok" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="arrow-si2" edge="1" parent="1" source="decision2" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#FF6F00;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" target="reescribir" value="">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="enviar-ok" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#C8E6C9;strokeColor=#388E3C;fontSize=14;fontStyle=1" value="âœ… Enviar respuesta&#xa;al usuario" vertex="1">
          <mxGeometry height="60" width="200" x="120" y="700" as="geometry" />
        </mxCell>
        <mxCell id="arrow3" edge="1" parent="1" source="reescribir" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#388E3C;exitX=0;exitY=1;entryX=1;entryY=0.5;" target="enviar-ok" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="350" y="710" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-fallback-end" edge="1" parent="1" source="fallback-box" style="endArrow=classic;html=1;strokeWidth=2;strokeColor=#D32F2F;exitX=0.5;exitY=1;entryX=1;entryY=0.75;dashed=1;entryDx=0;entryDy=0;" target="enviar-ok" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="900" y="550" />
              <mxPoint x="900" y="740" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="resultado-final" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1" value="ðŸ’¬ Usuario ve la respuesta en el Chat" vertex="1">
          <mxGeometry height="50" width="400" x="350" y="830" as="geometry" />
        </mxCell>
        <mxCell id="arrow-final" edge="1" parent="1" source="enviar-ok" style="endArrow=classic;html=1;strokeWidth=3;strokeColor=#1976D2;exitX=0.5;exitY=1;" target="resultado-final" value="">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="220" y="790" />
              <mxPoint x="220" y="850" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="CQYxunvka8uob3Wxy-jI-2" connectable="0" parent="1" style="group" value="" vertex="1">
          <mxGeometry height="120" width="280" x="420" y="520" as="geometry" />
        </mxCell>
        <mxCell id="reescribir" parent="CQYxunvka8uob3Wxy-jI-2" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF8E1;strokeColor=#FF6F00;strokeWidth=2;" value="" vertex="1">
          <mxGeometry height="120" width="280" as="geometry" />
        </mxCell>
        <mxCell id="CQYxunvka8uob3Wxy-jI-1" connectable="0" parent="CQYxunvka8uob3Wxy-jI-2" style="group" value="" vertex="1">
          <mxGeometry height="100" width="260" x="10" y="10" as="geometry" />
        </mxCell>
        <mxCell id="reescribir-title" parent="CQYxunvka8uob3Wxy-jI-1" style="text;html=1;strokeColor=none;fillColor=#FF6F00;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=11;fontStyle=1;fontColor=#FFFFFF" value="âœï¸ Reescribir con estilo documental" vertex="1">
          <mxGeometry height="25" width="260" as="geometry" />
        </mxCell>
        <mxCell id="reescribir-content" parent="CQYxunvka8uob3Wxy-jI-1" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" value="Transforma respuestas como:&#xa;&quot;Como modelo de IA...&quot;&#xa;â†“&#xa;&quot;De acuerdo con el Manual&#xa;de Convivencia...&quot;" vertex="1">
          <mxGeometry height="70" width="260" y="30" as="geometry" />
        </mxCell>
        <mxCell id="CQYxunvka8uob3Wxy-jI-4" connectable="0" parent="1" style="group" value="" vertex="1">
          <mxGeometry height="135" width="260" x="90" y="187" as="geometry" />
        </mxCell>
        <mxCell id="llm-title" parent="CQYxunvka8uob3Wxy-jI-4" style="text;html=1;strokeColor=none;fillColor=#388E3C;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=12;fontStyle=1;fontColor=#FFFFFF" value="ðŸ¤– Enviar a LLM con contexto" vertex="1">
          <mxGeometry height="25" width="260" as="geometry" />
        </mxCell>
        <mxCell id="llm-content" parent="CQYxunvka8uob3Wxy-jI-4" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11" value="ðŸ“ PROMPT + CONTEXTO&#xa;â†“&#xa;ðŸ¤– Llama 3.1 genera respuesta&#xa;â†“&#xa;ðŸ“‹ Respuesta basada en&#xa;el Manual de Convivencia" vertex="1">
          <mxGeometry height="100" width="260" y="35" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
